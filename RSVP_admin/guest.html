<style>
  #editPopupOverlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.4);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  }

  #editPopupOverlay .popup-box {
    background: white;
    padding: 20px;
    border-radius: 10px;
    min-width: 300px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
  }
</style>

<style>
  .custom-scroll::-webkit-scrollbar {
    width: 6px;
  }

  .custom-scroll::-webkit-scrollbar-thumb {
    background-color: #3b82f6; /* M√†u xanh n·ªïi b·∫≠t */
    border-radius: 3px;
  }

  .custom-scroll::-webkit-scrollbar-track {
    background: #e5e7eb; /* Tailwind gray-200 */
  }
</style>

<div class="w-full px-6 py-6 mx-auto">
  <!-- card 2 -->

  <div class="flex flex-wrap mt-6 -mx-3">
    <!-- B·∫£ng danh s√°ch -->
    <div class="w-full px-3 mt-0 lg:w-1 lg:flex-none">
      <div
        class="shadow-xl relative z-20 flex min-w-0 flex-col break-words rounded-2xl bg-white"
      >
        <div class="p-6 pb-0 mb-0">
          <div class="flex items-center justify-between flex-wrap">
            <h6 class="dark:text-white text-base font-semibold">
              Danh s√°ch kh√°ch m·ªùi
            </h6>

            <div class="flex items-center adminOnly">
              <label
                for="tableSelector"
                class="mr-2 text-sm font-medium text-gray-700 dark:text-white"
              >
                Ch·ªçn b·∫£ng d·ªØ li·ªáu:
              </label>
              <select
                id="tableSelector"
                class="text-sm rounded-lg border border-gray-300 bg-white px-3 py-1.5 dark:bg-slate-800 dark:text-white dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
                <!-- Option s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
              </select>
            </div>
          </div>
          <div class="flex items-center justify-between flex-wrap">
            <!-- N√∫t Xu·∫•t Excel b√™n tr√°i -->
            <a
              class="inline-block px-8 py-2 text-xs font-bold text-center text-white bg-blue-500 rounded-lg shadow-md hover:shadow-xs hover:-translate-y-px transition-all ease-in"
              href="#"
              onclick="event.preventDefault(); exportToExcel()"
            >
              Xu·∫•t Excel
            </a>

            <!-- N√∫t Nh·∫≠p Excel b√™n ph·∫£i -->
            <a
              class="inline-block px-8 py-2 text-xs font-bold text-center text-white bg-blue-500 rounded-lg shadow-md hover:shadow-xs hover:-translate-y-px transition-all ease-in adminOnly"
              href="#"
              data-bs-toggle="modal"
              data-bs-target="#exampleModal"
            >
              Nh·∫≠p Excel
            </a>
          </div>

          <div class="flex items-center justify-between flex-wrap">
            <div class="flex items-center"></div>
          </div>
        </div>

        <div class="flex-auto px-0 pt-0 pb-2">
          <div class="p-0 overflow-x-auto">
            <table
              class="items-center w-full mb-0 align-top border-collapse text-slate-500"
            >
              <thead class="align-bottom">
                <tr>
                  <th class="px-6 py-3 text-center">STT</th>
                  <th class="px-6 py-3 text-center">
                    T√™n kh√°ch m·ªùi (M√£ kh√°ch m·ªùi)
                  </th>
                  <th class="px-6 py-3 text-center">Nh√≥m kh√°ch m·ªùi</th>
                  <th class="px-6 py-3 text-center">S·ªë b√†n</th>
                  <th class="px-6 py-3 text-center adminOnly"></th>
                </tr>
              </thead>
              <tbody id="rsvpTableBody"></tbody>
            </table>
            <div id="pagination" class="mt-4 text-center"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="flex flex-wrap mt-6 -mx-3">
    <!-- To√†n b·ªô danh s√°ch b√†n -->
    <div class="w-full px-3 mt-0">
      <h6 class="text-lg font-bold mb-4">üìã Danh s√°ch c√°c b√†n:</h6>

      <!-- Grid danh s√°ch b√†n s·∫Ω ƒë·ªï v√†o ƒë√¢y -->
      <div id="tableCardGrid" class="flex flex-wrap mt-6 -mx-3"></div>
    </div>
  </div>
</div>
<div
  id="editPopupOverlay"
  class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden"
>
  <!-- Popup n·ªôi dung -->
  <div
    class="bg-white rounded-xl shadow-2xl p-6 w-[90%] max-w-md relative"
    style="width: 80%"
  >
    <h2 class="text-xl font-semibold mb-4">üìù S·ª≠a th√¥ng tin kh√°ch m·ªùi</h2>

    <input type="hidden" id="editId" />

    <div class="mb-3">
      <label class="block text-sm font-medium mb-1">M√£ kh√°ch m·ªùi:</label>
      <input
        type="text"
        id="editMa"
        class="w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
        readonly
      />
    </div>
    <div class="mb-3">
      <label class="block text-sm font-medium mb-1">T√™n kh√°ch m·ªùi:</label>
      <input
        type="text"
        id="editName"
        class="w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
      />
    </div>
    <div class="mb-3">
      <label class="block text-sm font-medium mb-1"
        >S·ªë l∆∞·ª£ng kh√°ch tham d·ª± c√πng:</label
      >
      <input
        type="text"
        id="editAttendPerson"
        class="w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
      />
    </div>
    <div class="mb-3">
      <label class="block text-sm font-medium mb-1">Nh√≥m kh√°ch m·ªùi:</label>
      <input
        type="text"
        id="editGroup"
        class="w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
      />
    </div>

    <div class="mb-3">
      <label class="block text-sm font-medium mb-1">S·ªë b√†n:</label>
      <select id="editTable" class="w-full border rounded px-3 py-2">
        <option value="0">Ch∆∞a ch·ªçn</option>
        <option value="1">B√†n 1</option>
      </select>
    </div>

    <div class="flex justify-end space-x-2">
      <button
        onclick="closePopup()"
        class="px-4 py-2 rounded bg-gray-300 hover:bg-gray-400 text-gray-800"
      >
        ‚ùå Hu·ª∑
      </button>
      <button
        onclick="saveEdit()"
        class="px-4 py-2 rounded bg-blue-600 hover:bg-blue-700 text-gray-800"
      >
        üíæ L∆∞u
      </button>
    </div>
  </div>
</div>

<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">
          Nh·∫≠p danh s√°ch kh√°ch m·ªùi
        </h1>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <div class="flex items-center justify-between flex-wrap adminOnly">
          <div class="flex items-center">
            <input type="file" id="excelFile" accept=".xlsx, .xls" />
          </div>
        </div>
      </div>
      <div class="modal-footer d-flex justify-content-between">
        <!-- B√™n tr√°i -->
        <button
          type="button"
          class="btn btn-outline-secondary"
          data-bs-dismiss="modal"
        >
          Close
        </button>

        <!-- B√™n ph·∫£i -->
        <div class="d-flex gap-2">
          <a
            href="/RSVP_admin/assets/guests_import.xlsx"
            download
            class="btn btn-outline-success"
          >
            T·∫£i file Excel
          </a>

          <a class="btn btn-primary" href="#" onclick="importExcel()">
            Nh·∫≠p v√†o
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
